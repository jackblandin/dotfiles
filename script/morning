#! /bin/bash -e

should_git_pull=true
should_stop_containers=false

if [ "$1" = "nopull" ] || [ "$2" = "nopull" ]; then should_git_pull=false; fi
if [ "$1" = "off" ] || [ "$2" = "off" ]; then should_stop_containers=true; fi

echo "should_git_pull: $should_git_pull"
echo "should_stop_containers: $should_stop_containers"

pg_ctl -D /usr/local/var/postgres -l /usr/local/var/postgres/server.log start
cd /Users/jackblandin/tc/service_manager
if [ should_git_pull ]; then git pull; fi
vagrant up
bundle exec rake start:update
if [ should_stop_containers ]; then bundle exec rake stop; fi
